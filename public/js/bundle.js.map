{"mappings":"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","sources":["public/js/index.js","public/js/mapbox.js","public/js/login.js","public/js/alerts.js","public/js/updateSettings.js","public/js/stripe.js"],"sourcesContent":["/* eslint-disable */\n// import 'core-js/stable';\n// import regeneratorRuntime from 'regenerator-runtime/runtime';\nimport { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\nimport { showAlert } from './alerts';\n\n// DOM ELEMENTS\nconst mapBox = document.querySelector('#map');\nconst loginForm = document.querySelector('.form--login');\nconst logoutButton = document.querySelector('.nav__el--logout');\nconst userDataForm = document.querySelector('.form-user-data');\nconst userPasswordForm = document.querySelector('.form-user-password');\nconst bookButton = document.querySelector('#book-tour');\n\n// VALUES\n\n// DELEGATION\nif (mapBox) {\n    const locations = JSON.parse(mapBox.dataset.locations);\n    displayMap(locations);\n}\n\nif (loginForm) {\n    loginForm.addEventListener('submit', (event) => {\n        event.preventDefault();\n        const email = document.querySelector('#email').value;\n        const password = document.querySelector('#password').value;\n        login(email, password);\n    });\n}\n\nif (logoutButton) logoutButton.addEventListener('click', logout);\n\nif (userDataForm) {\n    userDataForm.addEventListener('submit', (event) => {\n        event.preventDefault();\n        const form = new FormData();\n        form.append('name', document.querySelector('#name').value);\n        form.append('email', document.querySelector('#email').value);\n        form.append('photo', document.querySelector('#photo').files[0]);\n        updateSettings(form, 'data');\n    });\n}\n\nif (userPasswordForm) {\n    userPasswordForm.addEventListener('submit', (event) => {\n        event.preventDefault();\n        document.querySelector('.btn--save-password').textContent =\n            'Updating...';\n\n        const passwordCurrent =\n            document.querySelector('#password-current').value;\n        const password = document.querySelector('#password').value;\n        const passwordConfirm =\n            document.querySelector('#password-confirm').value;\n        updateSettings(\n            { passwordCurrent, password, passwordConfirm },\n            'password'\n        );\n\n        document.querySelector('.btn--save-password').textContent =\n            'Save password';\n        document.querySelector('#password-current').value = '';\n        document.querySelector('#password').value = '';\n        document.querySelector('#password-confirm').value = '';\n    });\n}\n\nif (bookButton) {\n    bookButton.addEventListener('click', (event) => {\n        event.target.textContent = 'Processing...';\n        const { tourId } = event.target.dataset;\n        bookTour(tourId);\n    });\n}\n\nconst alertMessage = document.querySelector('body').dataset.alert;\nif (alertMessage) showAlert('success', alertMessage, 20);\n","/* eslint-disable */\nexport const displayMap = (locations) => {\n    mapboxgl.accessToken =\n        'pk.eyJ1IjoiZGFsZW5sZWRpbmdoYW0iLCJhIjoiY2w3cXd6c2JpMDI0aDNvbnk4NmRoMzBrdCJ9.oKMgUDYQpJmKzpO_ljDB2Q';\n\n    const map = new mapboxgl.Map({\n        container: 'map',\n        style: 'mapbox://styles/dalenledingham/cl7qxk6z7002h15p0uzto6mo2',\n        scrollZoom: false,\n    });\n\n    const bounds = new mapboxgl.LngLatBounds();\n\n    locations.forEach((location) => {\n        // Create marker\n        const element = document.createElement('div');\n        element.className = 'marker';\n\n        // Add marker\n        new mapboxgl.Marker({\n            element,\n            anchor: 'bottom',\n        })\n            .setLngLat(location.coordinates)\n            .addTo(map);\n\n        // Create popup\n        new mapboxgl.Popup({ offset: 30 })\n            .setLngLat(location.coordinates)\n            .setHTML(`<p>Day ${location.day}: ${location.description}</p>`)\n            .addTo(map);\n\n        // Extend map bounds to include location\n        bounds.extend(location.coordinates);\n    });\n\n    // Add padding to map bounds\n    map.fitBounds(bounds, {\n        padding: {\n            top: 200,\n            bottom: 150,\n            left: 100,\n            right: 100,\n        },\n    });\n};\n","/* eslint-disable */\n// import axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const login = async (email, password) => {\n    try {\n        const res = await axios({\n            method: 'POST',\n            url: '/api/v1/users/login',\n            data: {\n                email,\n                password,\n            },\n        });\n\n        if (res.data.status === 'success') {\n            showAlert('success', 'Logged in successfully');\n            window.setTimeout(() => {\n                location.assign('/');\n            }, 1500);\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message);\n    }\n};\n\nexport const logout = async () => {\n    try {\n        const res = await axios({\n            method: 'GET',\n            url: '/api/v1/users/logout',\n        });\n\n        if (res.data.status === 'success') {\n            showAlert('success', 'Logging you out');\n            window.setTimeout(() => {\n                location.assign('/login');\n            }, 1500);\n        }\n    } catch (err) {\n        showAlert('error', 'Error logging out');\n    }\n};\n","/* eslint-disable */\n\nexport const hideAlert = () => {\n    const element = document.querySelector('.alert');\n    if (element) element.parentElement.removeChild(element);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, message, time = 7) => {\n    hideAlert();\n    const markup = `<div class=\"alert alert--${type}\">${message}</div>`;\n    document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n    window.setTimeout(hideAlert, time * 1000);\n};\n","/* eslint-disable */\n// import axios from 'axios';\nimport { showAlert } from './alerts';\n\n// type is 'data' or 'password'\nexport const updateSettings = async (data, type) => {\n    try {\n        const url =\n            type === 'password'\n                ? '/api/v1/users/update-my-password'\n                : '/api/v1/users/update-me';\n\n        const res = await axios({\n            method: 'PATCH',\n            url,\n            data: data,\n        });\n\n        if (res.data.status === 'success') {\n            showAlert(\n                'success',\n                `${\n                    type.charAt(0).toUpperCase() + type.slice(1)\n                } updated successfully`\n            );\n        }\n    } catch (err) {\n        showAlert('error', err.response.data.message);\n    }\n};\n","/* eslint-disable */\n// import axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const bookTour = async (tourId) => {\n    const stripe = Stripe(\n        'pk_test_51LhKX5EzAeShbKw4oK9pZbja6LornjXvGZTTgPej7mjK72yCwWoMGFh9bUV84QUw6CcwQSbjSVNdHLL5lA2Plmjj00hkEVPy45'\n    );\n    try {\n        // Get checkout session from API\n        const session = await axios(\n            `/api/v1/bookings/checkout-session/${tourId}`\n        );\n\n        // Create checkout form + charge credit card\n        await stripe.redirectToCheckout({ sessionId: session.data.session.id });\n    } catch (err) {\n        showAlert('error', err.response.data.message);\n    }\n};\n"],"names":[],"version":3,"file":"bundle.js.map","sourceRoot":"../../"}